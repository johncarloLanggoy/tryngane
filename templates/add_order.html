<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Leshley's Eatery - Add Order</title>
  <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
  <link rel="stylesheet" href="{{ url_for('static', filename='add_order.css') }}">
  <link rel="icon" type="image/png" href="{{ url_for('static', filename='logo.png') }}">
</head>
<body data-logged-in="{{ 'true' if session.get('user_id') else 'false' }}">
<header>
  <div class="logo" style="color: chocolate;">
    <img src="{{ url_for('static', filename='logo.png') }}" alt="Logo" class="logo-img">Leshley's Eatery
  </div>
  
  <div class="nav-wrapper">
    <nav class="nav-center">
      <div class="nav-dropdown">
        <button class="nav-btn dropdown-btn">Main Page<i class="bx bx-chevron-down"></i></button>
        <div class="dropdown-content">
          <a href="{{ url_for('home') }}"><i class="bx bx-home"></i> Home</a>
          <a href="{{ url_for('home') }}#about"><i class="bx bx-info-circle"></i> About Us</a>
          <a href="{{ url_for('home') }}#rate"><i class="bx bx-star"></i> Ratings</a>
          <a href="{{ url_for('home') }}#wews"><i class="bx bx-log-in"></i> Contacts</a>
        </div>
      </div>
      <a href="{{ url_for('dashboard') }}" class="nav-btn" title="Dashboard"><i class="bx bx-grid-alt"></i></a>
      {% if session.get('is_admin') %}
          <a href="{{ url_for('inventory') }}" class="nav-btn" title="Inventory"><i class="bx bx-box"></i></a>
      {% endif %}
      <a href="{{ url_for('add_order') }}" class="nav-btn active" title="Add Order"><i class="bx bx-cart-add"></i></a>
      {% if session.get('user_id') %}
      <a href="{{ url_for('view_orders') }}" class="nav-btn" title="Orders"><i class="bx bx-receipt"></i></a>
      {% endif %}
    </nav>

    <div class="nav-right profile-dropdown">
      <button class="nav-btn profile-btn">
        <i class="bx bx-user-circle"></i>
        <span>Profile</span>
        <i class="bx bx-chevron-down"></i>
      </button>
      <div class="profile-menu">
        {% if session.get('user_id') %}
          <a href="{{ url_for('logout') }}"><i class="bx bx-log-out"></i> Logout</a>
        {% else %}
          <a class="profile-action" href="{{ url_for('home') }}?form=login">
            <i class="bx bx-log-in"></i> Login
          </a>
        {% endif %}
      </div>
    </div>
  </div>
</header>

<h2 class="section-title">
  {% if session.get('username') %}
    <span class="highlight">{{ session.get('username') }}</span>, Order now!
  {% else %}
    <span class="highlight">Guest</span>, Order now!
  {% endif %}
</h2>

<div class="container">
  {% for item in menu_items %}
  <div class="card {% if item['availability'] != 'Available' %}unavailable{% endif %}" data-available="{{ 'true' if item['availability'] == 'Available' else 'false' }}">
    <h3>{{ item['name'] }}</h3>
    <img src="{{ url_for('static', filename=item['name'].replace(' ', '') + '.jpg') }}" alt="{{ item['name'] }}">
    <p>₱{{ item['price'] }}</p>
    <div class="quantity">
      <button class="minus {% if item['availability'] != 'Available' %}unavailable{% endif %}">-</button>
      <span class="count">0</span>
      <button class="plus {% if item['availability'] != 'Available' %}unavailable{% endif %}">+</button>
    </div>
  </div>
  {% endfor %}
</div>

<div class="footer-bar">
  <div>Total Price: ₱<span id="totalPrice">0.00</span></div>
  <button id="orderBtn" {% if not session.get('user_id') %}onclick="openGuestModal(); return false;"{% endif %}>Add to Order</button>
</div>

<div class="popup" id="orderPopup">
  <div class="popup-content">
    <span class="close-btn" id="closePopup">&times;</span>
    <h2>Confirm Your Order</h2>
    <div id="orderSummary"><p>No items selected yet.</p></div>
    <form id="orderForm" method="POST" action="{{ url_for('add_order') }}">
      <input type="text" name="cust_name" id="custName" placeholder="Enter your name" required>
      <input type="tel" name="cust_contact" id="custPhone" placeholder="Enter your phone number" required>
      <input type="text" name="order_date" id="orderDate" readonly>
      <div id="hiddenInputs"></div>
      <button type="submit">Confirm Order</button>
    </form>
  </div>
</div>

<script>
  // Pass the Flask URL to JS
  const homeUrl = "{{ url_for('home') }}";
</script>

<script src="{{ url_for('static', filename='add_order.js') }}"></script>
</body>
</html>
